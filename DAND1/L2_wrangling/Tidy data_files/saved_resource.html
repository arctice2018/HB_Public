<!DOCTYPE html>
<!-- saved from url=(0070)https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html -->
<html id="html"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link id="baseCSS" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/ClearlyReformatStyles.css" rel="stylesheet" class="newsprint" type="text/css"><style type="text/css" id="optionsCSS">#body { font-family: "PT Serif"; font-size: 16px; line-height: 1.5em; color: #1f0909; text-align: left; } #text { padding-top: 0;padding-bottom: 9em;} #background { background-color: #f3f2ee; } .setTextColorAsBackgroundColor { background-color: #1f0909; } .setBackgroundColorAsTextColor { color: #f3f2ee; } .setBackgroundColor { background-color: #f3f2ee; } .setTextColor { color: #1f0909; } #box, .setBoxWidth { width: 36em; } a { color: #065588; } a:visited { color: #1f0909; } @media print { body.footnote_links__on_print a, body.footnote_links__on_print a:hover { color: #1f0909 !important; text-decoration: none !important; } } body.footnote_links__always a, body.footnote_links__always a:hover { color: #1f0909 !important; text-decoration: none !important; } img { border-color: #1f0909; } a img { border-color: #065588; } a:visited img { border-color: #1f0909; } h1 a, h2 a, a h1, a h2 { color: #1f0909; } h1, h2, h3, h4, h5, h6 { font-family: "PT Serif"; } pre { background-color: #f3f2ee; } pre, code { font-family: Inconsolata; } hr { border-color: #1f0909; } html.rtl #body #text { text-align: right !important; } h1, h2, h3, h4, h5, h6 { text-align: left; } html.rtl h1, html.rtl h2, html.rtl h3, html.rtl h4, html.rtl h5, html.rtl h6 { text-align: right !important; } #text div.separatorLine, #text section::before { background:      -o-linear-gradient(0, #f3f2ee 1%, #1f0909 50%, #f3f2ee 99%); background:    -moz-linear-gradient(0, #f3f2ee 1%, #1f0909 50%, #f3f2ee 99%); background: -webkit-linear-gradient(0, #f3f2ee 1%, #1f0909 50%, #f3f2ee 99%); } </style><link href="./css" rel="stylesheet" type="text/css"><link href="./css(1)" rel="stylesheet" type="text/css"><script type="text/javascript" src="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/BrowserFrameLoader.js"></script><script type="text/javascript" src="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/FrameSerializer.js"></script><link type="text/css" rel="stylesheet" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/HighlightStyles.css"></head><body id="body" class="clearlyReady footnote_links__on_print large_graphics__do_nothing en-simplified-article clearly_highlighting_enabled"><div id="bodyContent" class="en-simplified-article"><div id="box"><div id="box_inner"><div id="text"><div id="pages"><div class="page" id="page1"><div class="page_content"><div id="articleHeader"><h1 id="articleHeader__title">Defining tidy data</h1><div id="articleHeader__separator" class="separator"><div class="separatorLine setTextColorAsBackgroundColor"></div></div></div>
<blockquote>
<p>Happy families are all alike; every unhappy family is unhappy in its own way — Leo Tolstoy</p>
</blockquote>
<p>Like families, tidy datasets are all alike but every messy dataset is messy in its own way. Tidy datasets provide a standardized way to link the structure of a dataset (its physical layout) with its semantics (its meaning). In this section, I’ll provide some standard vocabulary for describing the structure and semantics of a dataset, and then use those definitions to define tidy data.</p>
<div id="data-structure">
<h2>Data structure</h2>
<p>Most statistical datasets are data frames made up of <strong>rows</strong> and <strong>columns</strong>. The columns are almost always labeled and the rows are sometimes labeled. The following code provides some data about an imaginary experiment in a format commonly seen in the wild. The table has two columns and three rows, and both rows and columns are labeled.</p>
<div id="cb1"><pre><code>preg &lt;-read.csv("preg.csv", stringsAsFactors = FALSE)
preg
#&gt;           name treatmenta treatmentb
#&gt; 1   John Smith         NA         18
#&gt; 2     Jane Doe          4          1
#&gt; 3 Mary Johnson          6          7</code></pre></div>
<p>There are many ways to structure the same underlying data. The following table shows the same data as above, but the rows and columns have been transposed.</p>
<div id="cb2"><pre><code>read.csv("preg2.csv", stringsAsFactors = FALSE)
#&gt;   treatment John.Smith Jane.Doe Mary.Johnson
#&gt; 1         a         NA        4            6
#&gt; 2         b         18        1            7</code></pre></div>
<p>The data is the same, but the layout is different. Our vocabulary of rows and columns is simply not rich enough to describe why the two tables represent the same data. In addition to appearance, we need a way to describe the underlying semantics, or meaning, of the values displayed in the table.</p>
</div>
<div id="data-semantics">
<h2>Data semantics</h2>
<p>A dataset is a collection of <strong>values</strong>, usually either numbers (if quantitative) or strings (if qualitative). Values are organised in two ways. Every value belongs to a <strong>variable</strong> and an <strong>observation</strong>. A variable contains all values that measure the same underlying attribute (like height, temperature, duration) across units. An observation contains all values measured on the same unit (like a person, or a day, or a race) across attributes.</p>
<p>A tidy version of the pregnancy data looks like this: (you’ll learn how the functions work a little later)</p>
<div id="cb3"><pre><code>library(tidyr)
library(dplyr)
preg2 &lt;-preg %&gt;%
gather(treatment, n, treatmenta:treatmentb) %&gt;%
mutate(treatment = gsub("treatment", "", treatment)) %&gt;%
arrange(name, treatment)
preg2
#&gt;           name treatment  n
#&gt; 1     Jane Doe         a  4
#&gt; 2     Jane Doe         b  1
#&gt; 3   John Smith         a NA
#&gt; 4   John Smith         b 18
#&gt; 5 Mary Johnson         a  6
#&gt; 6 Mary Johnson         b  7</code></pre></div>
<p>This makes the values, variables and observations more clear. The dataset contains 18 values representing three variables and six observations. The variables are:</p>
<ol style="list-style-type: decimal;list-style:none;">
<li><p><code>name</code>, with three possible values (John, Mary, and Jane).</p></li>
<li><p><code>treatment</code>, with two possible values (a and b).</p></li>
<li><p><code>n</code>, with five or six values depending on how you think of the missing value (1, 4, 6, 7, 18, NA)</p></li>
</ol>
<p>The experimental design tells us more about the structure of the observations. In this experiment, every combination of of <code>name</code> and <code>treatment</code> was measured, a completely crossed design. The experimental design also determines whether or not missing values can be safely dropped. In this experiment, the missing value represents an observation that should have been made, but wasn’t, so it’s important to keep it. Structural missing values, which represent measurements that can’t be made (e.g., the count of pregnant males) can be safely removed.</p>
<p>For a given dataset, it’s usually easy to figure out what are observations and what are variables, but it is surprisingly difficult to precisely define variables and observations in general. For example, if the columns in the pregnancy data were <code>height</code> and <code>weight</code> we would have been happy to call them variables. If the columns were <code>height</code> and <code>width</code>, it would be less clear cut, as we might think of height and width as values of a <code>dimension</code> variable. If the columns were <code>home phone</code> and <code>work phone</code>, we could treat these as two variables, but in a fraud detection environment we might want variables <code>phone number</code> and <code>number type</code> because the use of one phone number for multiple people might suggest fraud. A general rule of thumb is that it is easier to describe functional relationships between variables (e.g., <code>z</code> is a linear combination of <code>x</code> and <code>y</code>, <code>density</code> is the ratio of <code>weight</code> to <code>volume</code>) than between rows, and it is easier to make comparisons between groups of observations (e.g., average of group a vs.&nbsp;average of group b) than between groups of columns.</p>
<p>In a given analysis, there may be multiple levels of observation. For example, in a trial of new allergy medication we might have three observational types: demographic data collected from each person (<code>age</code>, <code>sex</code>, <code>race</code>), medical data collected from each person on each day (<code>number of sneezes</code>, <code>redness of eyes</code>), and meteorological data collected on each day (<code>temperature</code>, <code>pollen count</code>).</p>
<p>Variables may change over the course of analysis. Often the variables in the raw data are very fine grained, and may add extra modelling complexity for little explanatory gain. For example, many surveys ask variations on the same question to better get at an underlying trait. In early stages of analysis, variables correspond to questions. In later stages, you change focus to traits, computed by averaging together multiple questions. This considerably simplifies analysis because you don’t need a hierarchical model, and you can often pretend that the data is continuous, not discrete.</p>
</div>
<div id="tidy-data">
<h2>Tidy data</h2>
<p>Tidy data is a standard way of mapping the meaning of a dataset to its structure. A dataset is messy or tidy depending on how rows, columns and tables are matched up with observations, variables and types. In <strong>tidy data</strong>:</p>
<ol style="list-style-type: decimal;list-style:none;">
<li><p>Each variable forms a column.</p></li>
<li><p>Each observation forms a row.</p></li>
<li><p>Each type of observational unit forms a table.</p></li>
</ol>
<p>This is Codd’s 3rd normal form, but with the constraints framed in statistical language, and the focus put on a single dataset rather than the many connected datasets common in relational databases. <strong>Messy data</strong> is any other arrangement of the data.</p>
<p>Tidy data makes it easy for an analyst or a computer to extract needed variables because it provides a standard way of structuring a dataset. Compare the different versions of the pregnancy data: in the messy version you need to use different strategies to extract different variables. This slows analysis and invites errors. If you consider how many data analysis operations involve all of the values in a variable (every aggregation function), you can see how important it is to extract these values in a simple, standard way. Tidy data is particularly well suited for vectorised programming languages like R, because the layout ensures that values of different variables from the same observation are always paired.</p>
<p>While the order of variables and observations does not affect analysis, a good ordering makes it easier to scan the raw values. One way of organising variables is by their role in the analysis: are values fixed by the design of the data collection, or are they measured during the course of the experiment? Fixed variables describe the experimental design and are known in advance. Computer scientists often call fixed variables dimensions, and statisticians usually denote them with subscripts on random variables. Measured variables are what we actually measure in the study. Fixed variables should come first, followed by measured variables, each ordered so that related variables are contiguous. Rows can then be ordered by the first variable, breaking ties with the second and subsequent (fixed) variables. This is the convention adopted by all tabular displays in this paper.</p>
</div>
</div></div></div><div id="footnotedLinks" class="separateSection"><div id="footnotedLinks__separator" class="separator"><div class="separatorLine setTextColorAsBackgroundColor"></div></div><ol id="footnotedLinks__list"></ol></div><div id="measure__lineHeight">Measure</div><div id="measure__fontSize">Measure</div></div></div></div><div id="background"></div></div><link rel="stylesheet" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/ClearlyReformatStyles.css" type="text/css"></body></html>