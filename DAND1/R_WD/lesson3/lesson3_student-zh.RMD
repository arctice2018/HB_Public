第 3 课
========================================================

***

### 首先做什么？
注释：提出问题，需要关注那些变量。

***

### Facebook 匿名用户数据
注释：查看当前工作目录，加载数据到pf中

```{r Pseudo-Facebook User Data}
getwd()
pf <- read.csv('pseudo_facebook.tsv',sep = '\t')
```
查看数据集相关内容，比如数据集的维度，变量有那些，数据的类型，
```{r}
dim(pf)
names(pf)
str(pf)
summary(pf)
```

***

### 用户生日的直方图
注释：首先加载ggplot2

```{r Histogram of Users\' Birthdays}
library(ggplot2)
```
```{r}
ggplot(aes(x = dob_day), data = pf) +
  geom_histogram(binwidth = 1) +
  scale_x_continuous(breaks = c(1:31))
```

***

#### 在这个直方图中你注意到哪些事情？
回复：出生日在1日的数量最多，31日的最少。

***

### Moira 的调查
注释：

***

### 估算关注量
注释：

***

#### 思考一下，你在 Facebook 发布特定信息或分享图片的时间。什么时间呢？
回复：

#### 你认为多少朋友会看到你的发布？
回复：

#### 思考一下，你在 Facebook 每个月发布信息或进行评论的比例。你认为这个百分比是多少？
回复：

***

### 自我感知的关注量
注释：

***
### 拆分
注释：

```{r Faceting}
ggplot(aes(x = dob_day),data = pf) +
  geom_histogram(binwidth = 1) +
  scale_x_continuous(breaks=c(1:31)) +
  facet_wrap(~dob_month)
```

#### 我们再观察一下这个图。这里你发现了什么？
回复：只有1月1日的数量最多，其他的月份的1日和其他日期的数量都比较平均。

***

### 保持怀疑态度：离群值和异常情况
注释：

***

### Moira 的离群值
注释：
#### 你认为哪些情况适用于 Moira 的离群值？
回复：

***

### 好友数
注释：

#### 你会输入哪个代码，创建朋友数量的直方图？

```{r Friend Count}
ggplot(data = pf,aes(x = friend_count)) +
  geom_histogram() +
  scale_x_continuous()
```

#### 这个图与 Moira 的第一个图有哪些相似的地方？
回复：分布都是长尾，右偏。

***

### 限制轴线
注释：

```{r Limiting the Axes}
ggplot(aes(x = friend_count), data = pf) +
  geom_histogram() +
  scale_x_continuous(limits = c(0, 1000))
```

### 探究箱宽
注释：

***

### 调整箱宽
注释：

### 拆分好友数
```{r Faceting Friend Count}
# 你会输入哪个代码，创建按照性别的直方图平面？
# 将它增加到下列代码中。
qplot(x = friend_count, data = pf, binwidth = 25) +
  scale_x_continuous(limits = c(0, 1000),
                     breaks = seq(0, 1000, 50))+
  facet_wrap(~gender)

```

***

### 省略不适用的数值
注释：

```{r Omitting NA Values}
ggplot(data = subset(pf,!is.na(gender)),aes(x = friend_count)) +
  geom_histogram(binwidth = 25) +
  scale_x_continuous(limits = c(0,1000),breaks = seq.int(0,1000,50)) +
  facet_grid(.~gender)
```

***

### '根据' 性别的统计量
注释：

```{r Statistics \'by\' Gender}
by(pf$friend_count,pf$gender,summary)
```
```{r}
table(pf$gender)
```

#### 哪些人朋友更多，男性还是女性？
回复：male

#### 女性和男性的朋友数量中位数有哪些不同？
回复：female

#### 为什么中位数是比平均数更好的测量方法？
回复：相比mean，median不受异常值影响。

***

### 使用时长
注释：

```{r Tenure}
ggplot(aes(x=tenure),data = pf) +
  geom_histogram(binwidth =30,color = I('black'),fill = I('#099DD9') )
```

***

#### 你如何按照年份创建任期的直方图？

```{r Tenure Histogram by Year}
ggplot(aes(x = tenure/365),data = pf) +
  geom_histogram(binwidth = 0.25,color =I('black'),fill = I('orange')) +
  scale_x_continuous(breaks = seq(1,7,1),limits = c(0,7))
```

***

### 标签图
注释：

```{r Labeling Plots}
ggplot(aes(x = tenure / 365), data = pf) +
  geom_histogram(color = 'black', fill = '#F79420') +
  scale_x_continuous(breaks = seq(1, 7, 1), limits = c(0, 7)) +
  xlab('Number of years using Facebook') +
  ylab('Number of users in sample')
```

***

### 用户年龄
注释：

```{r User Ages}
ggplot(aes(x = age),data = pf) +
  geom_histogram(binwidth = 1,color = I('black'),fill=I('blue')) +
  scale_x_continuous(breaks = seq(0,100,5),limits = c(0,100)) +
  xlab("the range of age of which use the facebook") +
  ylab(('count'))
```

#### 你发现了什么？
回复：使用facebook的用户，大多数的年龄在15到30岁之间。
### 数据转换

```{r}
p1 <- ggplot(aes(x = friend_count),data = pf) +
  geom_histogram() +
  scale_x_continuous()
p2 <- ggplot(aes(x = log10(friend_count)+1),data = pf) + 
  geom_histogram() +
  scale_x_log10()
p3 <- ggplot(aes(x = sqrt(friend_count)),data = pf) + 
  geom_histogram() +
  scale_x_sqrt()

grid.arrange(p1,p2,p3,ncol=1)
  
```

### 频数多边图

```{r Frequency Polygons}
ggplot(aes(x = friend_count, y = ..count../sum(..count..)), data = subset(pf, !is.na(gender))) +
  geom_freqpoly(aes(color = gender), binwidth=10) +
  scale_x_continuous(limits = c(0, 1000), breaks = seq(0, 1000, 50)) +
  xlab('friend_count') +
  ylab('Percentage of users with that friend count')
```

***

### 网页上的赞数
注释：

```{r Likes on the Web}
by(pf$www_likes,pf$gender,sum)
```

***

### 箱线图
注释：

```{r Box Plots}
ggplot(aes(x = gender,y=friend_count),data = subset(pf,!is.na(pf$gender))) +
  geom_boxplot() +
  scale_y_continuous(limits = c(0,1000),breaks = seq(0,1000,50))
```

#### 调整代码，关注朋友数量在 0 到 1000 之间的用户。

```{r}
ggplot(aes(x = gender,y = friend_count),data = subset(pf,!is.na(gender))) +
  geom_boxplot() +
  coord_cartesian(ylim = c(0,1000))
```
###
使用scale_y_continuous,实际上是截取了一部分数据，会改变原有数据的四分位情况，推荐使用cood_cartesian()函数。
***
```{r}
ggplot(aes(x = gender,y = friend_count),data = subset(pf,!is.na(gender))) +
  geom_boxplot() +
  coord_cartesian(ylim = c(0,250))
```

### 箱线图、分位数和友情
注释：

```{r Box Plots, Quartiles, and Friendships}
ggplot(data = subset(pf,!is.na(gender)),aes(x = gender,y = friendships_initiated)) +
  geom_boxplot() +
  coord_cartesian(ylim = c(0,150))
```

#### 一般来说，我们样本中哪些人更容易交朋友，男性还是女性？
回复：
#### 写出可以验证答案的一些方法。
回复：
```{r Friend Requests by Gender}
by(pf$friendships_initiated,pf$gender,summary)
```

回复：

***

### 得到逻辑
注释：

```{r Getting Logical}
pf$mobile_check_in <- I('NA')
pf$mobile_check_in <- ifelse(pf$mobile_likes >0,1,0)
pf$mobile_check_in <- factor(pf$mobile_check_in)
summary(pf$mobile_check_in)
sum(pf$mobile_check_in == 1)/length(pf$mobile_check_in)
```

回复：

***

### 分析一个变量
思考：重要的不是数据是什么类型，重要的是我们需要什么样的数据类型，以本代码为例，我们不需要移动终端访问的次数，我们需要是否用终端进行访问，因此，我们将相关变量转换为二元的类型。

***

点击 **KnitHTML** 查看你的成果和这节课的 html 页面、
答案和注释！